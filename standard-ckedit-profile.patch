--- drupal-7.0/profiles/standard/standard.install	2011-01-04 19:24:24.000000000 +0100
+++ ckedit/profiles/ckedit/ckedit.install	2011-01-06 17:48:51.926657334 +0100
@@ -1,17 +1,17 @@
 <?php
-// $Id: standard.install,v 1.30 2011/01/04 18:24:24 webchick Exp $
+// $Id:
 
 /**
  * Implements hook_install().
  *
  * Perform actions to set up the site for this profile.
  */
-function standard_install() {
+function ckedit_install() {
   // Add text formats.
   $filtered_html_format = array(
     'format' => 'filtered_html',
     'name' => 'Filtered HTML',
-    'weight' => 0,
+    'weight' => 1,
     'filters' => array(
       // URL filter.
       'filter_url' => array(
@@ -41,7 +41,7 @@ function standard_install() {
   $full_html_format = array(
     'format' => 'full_html',
     'name' => 'Full HTML',
-    'weight' => 1,
+    'weight' => 2,
     'filters' => array(
       // URL filter.
       'filter_url' => array(
@@ -63,6 +63,38 @@ function standard_install() {
   $full_html_format = (object) $full_html_format;
   filter_format_save($full_html_format);
 
+  // ckedit: add a new text format
+  $ckedit_format = array(
+    'format' => 'ckeditor',
+    'name' => 'CKEditor',
+    // put to the top of the format list
+    'weight' => 0,
+    'filters' => array(
+      // URL filter.
+      'filter_url' => array(
+        'weight' => 0,
+        'status' => 1,
+      ),
+      // HTML filter    --------------------  TBD ---------------
+      'filter_html' => array(
+        'weight' => 1,
+        'status' => 1,
+      ),
+      // Line break filter.
+      'filter_autop' => array(
+        'weight' => 2,
+        'status' => 1,
+      ),
+      // HTML corrector filter.
+      'filter_htmlcorrector' => array(
+        'weight' => 10,
+        'status' => 1,
+      ),
+    ),
+  );
+  $ckedit_format = (object) $ckedit_format;
+  filter_format_save($ckedit_format);
+
   // Enable some standard blocks.
   $default_theme = variable_get('theme_default', 'bartik');
   $admin_theme = 'seven';
@@ -403,6 +435,15 @@ function standard_install() {
   // Set this as the administrator role.
   variable_set('user_admin_role', $admin_role->rid);
 
+  // ckedit: Create new role and permission for ckedit features
+  $ckedit_role = new stdClass();
+  $ckedit_role->name = 'ckedit';
+  $ckedit_role->weight = 3;
+  user_role_save($ckedit_role);
+  // add permissions to that new role
+  $ckedit_format_permission = filter_permission_name($ckedit_format);
+  user_role_grant_permissions($ckedit_role->rid, array('access content', 'access comments', 'post comments', 'skip comment approval', $ckedit_format_permission));
+
   // Assign user 1 the "administrator" role.
   db_insert('users_roles')
     ->fields(array('uid' => 1, 'rid' => $admin_role->rid))
@@ -427,4 +468,39 @@ function standard_install() {
     ->execute();
   variable_set('admin_theme', 'seven');
   variable_set('node_admin_theme', '1');
+  
+  // ckedit: db inserts in order to configure the CKEditor buttons and other features
+	db_insert('wysiwyg')
+	  ->fields(array(
+		'format' => 'ckeditor',
+		'editor' => 'ckeditor',
+		'settings' => 'a:21:{s:7:"default";i:1;s:11:"user_choose";i:0;s:11:"show_toggle";i:0;s:5:"theme";s:8:"advanced";s:8:"language";s:2:"en";s:15:"wysiwyg_buttons";a:3:{s:7:"default";a:48:{s:4:"Bold";i:1;s:6:"Italic";i:1;s:9:"Underline";i:1;s:6:"Strike";i:1;s:11:"JustifyLeft";i:1;s:13:"JustifyCenter";i:1;s:12:"JustifyRight";i:1;s:12:"JustifyBlock";i:1;s:12:"BulletedList";i:1;s:12:"NumberedList";i:1;s:7:"Outdent";i:0;s:6:"Indent";i:0;s:4:"Undo";i:0;s:4:"Redo";i:0;s:4:"Link";i:1;s:6:"Unlink";i:0;s:6:"Anchor";i:0;s:5:"Image";i:1;s:9:"TextColor";i:0;s:7:"BGColor";i:0;s:11:"Superscript";i:1;s:9:"Subscript";i:1;s:10:"Blockquote";i:0;s:6:"Source";i:0;s:14:"HorizontalRule";i:0;s:3:"Cut";i:0;s:4:"Copy";i:0;s:5:"Paste";i:0;s:9:"PasteText";i:0;s:13:"PasteFromWord";i:0;s:10:"ShowBlocks";i:0;s:12:"RemoveFormat";i:0;s:11:"SpecialChar";i:0;s:6:"Format";i:0;s:4:"Font";i:0;s:8:"FontSize";i:1;s:6:"Styles";i:0;s:5:"Table";i:0;s:9:"SelectAll";i:0;s:4:"Find";i:0;s:7:"Replace";i:0;s:5:"Flash";i:0;s:6:"Smiley";i:0;s:9:"CreateDiv";i:0;s:8:"Maximize";i:0;s:12:"SpellChecker";i:0;s:5:"Scayt";i:0;s:5:"About";i:0;}s:4:"imce";a:1:{s:4:"imce";i:1;}s:6:"drupal";a:1:{s:5:"break";i:0;}}s:11:"toolbar_loc";s:3:"top";s:13:"toolbar_align";s:4:"left";s:8:"path_loc";s:6:"bottom";s:8:"resizing";i:1;s:11:"verify_html";i:1;s:12:"preformatted";i:0;s:22:"convert_fonts_to_spans";i:1;s:17:"remove_linebreaks";i:1;s:23:"apply_source_formatting";i:0;s:27:"paste_auto_cleanup_on_paste";i:0;s:13:"block_formats";s:32:"p,address,pre,h2,h3,h4,h5,h6,div";s:11:"css_setting";s:5:"theme";s:8:"css_path";s:0:"";s:11:"css_classes";s:0:"";s:7:"buttons";a:2:{s:7:"default";a:15:{s:4:"Bold";i:1;s:6:"Italic";i:1;s:9:"Underline";i:1;s:6:"Strike";i:1;s:11:"JustifyLeft";i:1;s:13:"JustifyCenter";i:1;s:12:"JustifyRight";i:1;s:12:"JustifyBlock";i:1;s:12:"BulletedList";i:1;s:12:"NumberedList";i:1;s:4:"Link";i:1;s:5:"Image";i:1;s:11:"Superscript";i:1;s:9:"Subscript";i:1;s:8:"FontSize";i:1;}s:4:"imce";a:1:{s:4:"imce";i:1;}}}',
+	  ))
+	->execute();
+	db_insert('wysiwyg')
+	  ->fields(array(
+		'format' => 'filtered_html',
+		'editor' => '',
+		'settings' => NULL,
+	  ))
+	->execute();
+	db_insert('wysiwyg')
+	  ->fields(array(
+		'format' => 'full_html',
+		'editor' => '',
+		'settings' => NULL,
+	  ))
+	->execute();
+	db_insert('wysiwyg')
+	  ->fields(array(
+		'format' => 'plain_text_html',
+		'editor' => '',
+		'settings' => NULL,
+	  ))
+	->execute();
+	
+  // ckedit: delete variables having default values
+  // see also: http://drupal.org/node/840080#comment-3145536 
+  variable_del('imce_profiles');
+  variable_del('site_name');
 }
